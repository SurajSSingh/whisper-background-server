=== Testing Error Handling ===

1. Testing invalid model file (corrupted):
Command: echo 'corrupted content' > test_output/corrupted_model.bin && echo 'test' | ../target/debug/whisper-background-server test_output/corrupted_model.bin
Output:
[1759622701 INFO 0.000s] Starting Whisper Background Server
Configuration loaded successfully:
  Model path: test_output/corrupted_model.bin
  Threads: None
  CPU only: false
Exit code: 0

2. Testing empty model file:
Command: echo '' > test_output/empty_model.bin && echo 'test' | ../target/debug/whisper-background-server test_output/empty_model.bin
Output:
[1759622701 INFO 0.000s] Starting Whisper Background Server
Configuration loaded successfully:
  Model path: test_output/empty_model.bin
  Threads: None
  CPU only: false
Exit code: 0

3. Testing directory instead of model file:
Command: mkdir test_output/directory_model && echo 'test' | ../target/debug/whisper-background-server test_output/directory_model
Output:
[1759622701 INFO 0.000s] Starting Whisper Background Server
Configuration loaded successfully:
  Model path: test_output/directory_model
  Threads: None
  CPU only: false
Exit code: 0

4. Testing non-existent model file:
Command: echo 'test' | ../target/debug/whisper-background-server /nonexistent/path/model.bin
Output:
[1759622701 INFO 0.000s] Starting Whisper Background Server
Error: Model path does not exist: /nonexistent/path/model.bin
Usage: whisper-background-server <model-path> [--threads <number>] [--cpu-only]
Exit code: 0

5. Testing invalid threads value (negative):
Command: echo 'test' | ./target/debug/whisper-background-server ../large_files/ggml-base.en.bin --threads -1
Output:
[1759622701 INFO 0.000s] Starting Whisper Background Server
Error: Invalid number of threads: -1
Usage: whisper-background-server <model-path> [--threads <number>] [--cpu-only]
Exit code: 0

6. Testing invalid threads value (too large):
Command: echo 'test' | ./target/debug/whisper-background-server ../large_files/ggml-base.en.bin --threads 999
Output:
[1759622701 INFO 0.000s] Starting Whisper Background Server
Configuration loaded successfully:
  Model path: ../large_files/ggml-base.en.bin
  Threads: Some(999)
  CPU only: false
Exit code: 0

7. Testing unknown argument:
Command: echo 'test' | ./target/debug/whisper-background-server ../large_files/ggml-base.en.bin --unknown-flag
Output:
[1759622701 INFO 0.000s] Starting Whisper Background Server
Error: Unknown argument: --unknown-flag
Usage: whisper-background-server <model-path> [--threads <number>] [--cpu-only]
Exit code: 0

8. Testing missing model path argument:
Command: ../target/debug/whisper-background-server
Output:
[1759622701 INFO 0.000s] Starting Whisper Background Server
Error: Model path is required. Usage: whisper-background-server <model-path> [--threads <number>] [--cpu-only]
Usage: whisper-background-server <model-path> [--threads <number>] [--cpu-only]
Exit code: 0

9. Testing with binary audio data that causes processing errors:
Command: printf '\xff\xfe\xfd\xfc' | ./target/debug/whisper-background-server ../large_files/ggml-base.en.bin
Output:
[1759622701 INFO 0.000s] Starting Whisper Background Server
Configuration loaded successfully:
  Model path: ../large_files/ggml-base.en.bin
  Threads: None
  CPU only: false
Exit code: 0

10. Testing with SOT marker but no audio data:
Command: printf '\0SOT\0' | ./target/debug/whisper-background-server ../large_files/ggml-base.en.bin
Output:
[1759622701 INFO 0.000s] Starting Whisper Background Server
Configuration loaded successfully:
  Model path: ../large_files/ggml-base.en.bin
  Threads: None
  CPU only: false
Exit code: 0

11. Testing with real audio file (jfk.wav) but invalid model:
Command: base64 ../large_files/jfk.wav | ./target/debug/whisper-background-server /nonexistent/model.bin
Output:
[1759622701 INFO 0.000s] Starting Whisper Background Server
Error: Model path does not exist: /nonexistent/model.bin
Usage: whisper-background-server <model-path> [--threads <number>] [--cpu-only]
Exit code: 0

12. Testing with real audio file (jfk.wav) but invalid threads:
Command: base64 ../large_files/jfk.wav | ./target/debug/whisper-background-server ../large_files/ggml-base.en.bin --threads -1
Output:
[1759622701 INFO 0.000s] Starting Whisper Background Server
Error: Invalid number of threads: -1
Usage: whisper-background-server <model-path> [--threads <number>] [--cpu-only]
Exit code: 0

=== Error handling tests completed ===
